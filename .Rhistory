filter(treatmentID == 'ThalaCux_15_HI') %>%
filter(sampling <sampling_death)
N0s<- median(ThalaCux15r1$value[ThalaCux15r1$sampling==1] )#Set the start OD-value (Day=1)
Daymax<-max(ThalaCux15r1$sampling) #Select the maximum number of days (time of incubation)
Ks<-median(ThalaCux15r1$value[ThalaCux15r1$sampling==Daymax])#Estimated value for K (Carrying Capacity) = Time of incubation
rs<-0.13#Estimated growth rate (r)
ThalaCux15_model <- nls(value ~ K*N0*exp(r*sampling)/(K+N0*(exp(r*sampling)-1)),
start=list(N0=N0s,K=Ks,r=rs),
data = ThalaCux15r1)
summary(ThalaCux15_model)
sum_modeL <-summary(ThalaCux15_model)
N0 <- sum_modeL$coefficients[1,1] #N0
K  <- sum_modeL$coefficients[2,1] #K
r  <- sum_modeL$coefficients[3,1] #r
pK  <- sum_modeL$coefficients[2,4] #pK
pr  <- sum_modeL$coefficients[3,4] #pr
ThalaCux15r1 $N0 <- N0
ThalaCux15r1 $K <- K
ThalaCux15r1 $r <- r
ThalaCux15r1 $pK <- pK
ThalaCux15r1 $pr <- pr
ggplot(ThalaCux15r1, aes(x = sampling, y = value))+
geom_point()+
geom_line(data = ThalaCux15r1, aes(x = sampling, y = predict(ThalaCux15_model)))
## ThalaCux 15 Low
ThalaCux15Lr1<- tbl %>%
filter(wavelength1 %in% c('440')) %>%
mutate(treatmentID = paste(species, temperature, nut, sep = '_'),
log = log(value)) %>%
filter(treatmentID == 'ThalaCux_15_Low') %>%
filter(sampling <sampling_death)
N0s<- median(ThalaCux15Lr1$value[ThalaCux15Lr1$sampling==1] )#Set the start OD-value (Day=1)
Daymax<-max(ThalaCux15Lr1$sampling) #Select the maximum number of days (time of incubation)
Ks<-median(ThalaCux15Lr1$value[ThalaCux15Lr1$sampling==Daymax])#Estimated value for K (Carrying Capacity) = Time of incubation
rs<-0.13#Estimated growth rate (r)
ThalaCux15_model <- nls(value ~ K*N0*exp(r*sampling)/(K+N0*(exp(r*sampling)-1)),
start=list(N0=N0s,K=Ks,r=rs),
data = ThalaCux15Lr1)
summary(ThalaCux15_model)
sum_modeL <-summary(ThalaCux15_model)
N0 <- sum_modeL$coefficients[1,1] #N0
K  <- sum_modeL$coefficients[2,1] #K
r  <- sum_modeL$coefficients[3,1] #r
pK  <- sum_modeL$coefficients[2,4] #pK
pr  <- sum_modeL$coefficients[3,4] #pr
ThalaCux15Lr1 $N0 <- N0
ThalaCux15Lr1 $K <- K
ThalaCux15Lr1 $r <- r
ThalaCux15Lr1 $pK <- pK
ThalaCux15Lr1 $pr <- pr
ggplot(ThalaCux15Lr1, aes(x = sampling, y = value))+
geom_point()+
geom_line(data = ThalaCux15Lr1, aes(x = sampling, y = predict(ThalaCux15_model)))
## ThalaCux 18 HI
ThalaCux18r1<- tbl %>%
filter(wavelength1 %in% c('440')) %>%
mutate(treatmentID = paste(species, temperature, nut, sep = '_'),
log = log(value)) %>%
filter(treatmentID == 'ThalaCux_18_HI') %>%
filter(sampling <sampling_death)
N0s<- median(ThalaCux18r1$value[ThalaCux18r1$sampling==1] )#Set the start OD-value (Day=1)
Daymax<-max(ThalaCux18r1$sampling) #Select the maximum number of days (time of incubation)
Ks<-median(ThalaCux18r1$value[ThalaCux18r1$sampling==Daymax])#Estimated value for K (Carrying Capacity) = Time of incubation
rs<-0.13#Estimated growth rate (r)
ThalaCux18_model <- nls(value ~ K*N0*exp(r*sampling)/(K+N0*(exp(r*sampling)-1)),
start=list(N0=N0s,K=Ks,r=rs),
data = ThalaCux18r1)
summary(ThalaCux18_model)
sum_modeL <-summary(ThalaCux18_model)
N0 <- sum_modeL$coefficients[1,1] #N0
K  <- sum_modeL$coefficients[2,1] #K
r  <- sum_modeL$coefficients[3,1] #r
pK  <- sum_modeL$coefficients[2,4] #pK
pr  <- sum_modeL$coefficients[3,4] #pr
ThalaCux18r1 $N0 <- N0
ThalaCux18r1 $K <- K
ThalaCux18r1 $r <- r
ThalaCux18r1 $pK <- pK
ThalaCux18r1 $pr <- pr
ggplot(ThalaCux18r1, aes(x = sampling, y = value))+
geom_point()+
geom_line(data = ThalaCux18r1, aes(x = sampling, y = predict(ThalaCux18_model)))
## ThalaCux 18 Low
ThalaCux18Lr1<- tbl %>%
filter(wavelength1 %in% c('440')) %>%
mutate(treatmentID = paste(species, temperature, nut, sep = '_'),
log = log(value)) %>%
filter(treatmentID == 'ThalaCux_18_Low') %>%
filter(sampling <sampling_death)
N0s<- median(ThalaCux18Lr1$value[ThalaCux18Lr1$sampling==1] )#Set the start OD-value (Day=1)
Daymax<-max(ThalaCux18Lr1$sampling) #Select the maximum number of days (time of incubation)
Ks<-median(ThalaCux18Lr1$value[ThalaCux18Lr1$sampling==Daymax])#Estimated value for K (Carrying Capacity) = Time of incubation
rs<-0.13#Estimated growth rate (r)
ThalaCux18_model <- nls(value ~ K*N0*exp(r*sampling)/(K+N0*(exp(r*sampling)-1)),
start=list(N0=N0s,K=Ks,r=rs),
data = ThalaCux18Lr1)
summary(ThalaCux18_model)
sum_modeL <-summary(ThalaCux18_model)
N0 <- sum_modeL$coefficients[1,1] #N0
K  <- sum_modeL$coefficients[2,1] #K
r  <- sum_modeL$coefficients[3,1] #r
pK  <- sum_modeL$coefficients[2,4] #pK
pr  <- sum_modeL$coefficients[3,4] #pr
ThalaCux18Lr1 $N0 <- N0
ThalaCux18Lr1 $K <- K
ThalaCux18Lr1 $r <- r
ThalaCux18Lr1 $pK <- pK
ThalaCux18Lr1 $pr <- pr
ggplot(ThalaCux18Lr1, aes(x = sampling, y = value))+
geom_point()+
geom_line(data = ThalaCux18Lr1, aes(x = sampling, y = predict(ThalaCux18_model)))
## ThalaCux 21 HI
ThalaCux21r1<- tbl %>%
filter(wavelength1 %in% c('440')) %>%
mutate(treatmentID = paste(species, temperature, nut, sep = '_'),
log = log(value)) %>%
filter(treatmentID == 'ThalaCux_21_HI') %>%
filter(sampling <sampling_death)
N0s<- median(ThalaCux21r1$value[ThalaCux21r1$sampling==1] )#Set the start OD-value (Day=1)
Daymax<-max(ThalaCux21r1$sampling) #Select the maximum number of days (time of incubation)
Ks<-median(ThalaCux21r1$value[ThalaCux21r1$sampling==Daymax])#Estimated value for K (Carrying Capacity) = Time of incubation
rs<-0.13#Estimated growth rate (r)
ThalaCux21_model <- nls(value ~ K*N0*exp(r*sampling)/(K+N0*(exp(r*sampling)-1)),
start=list(N0=N0s,K=Ks,r=rs),
data = ThalaCux21r1)
summary(ThalaCux21_model)
sum_modeL <-summary(ThalaCux21_model)
N0 <- sum_modeL$coefficients[1,1] #N0
K  <- sum_modeL$coefficients[2,1] #K
r  <- sum_modeL$coefficients[3,1] #r
pK  <- sum_modeL$coefficients[2,4] #pK
pr  <- sum_modeL$coefficients[3,4] #pr
ThalaCux21r1 $N0 <- N0
ThalaCux21r1 $K <- K
ThalaCux21r1 $r <- r
ThalaCux21r1 $pK <- pK
ThalaCux21r1 $pr <- pr
ggplot(ThalaCux21r1, aes(x = sampling, y = value))+
geom_point()+
geom_line(data = ThalaCux21r1, aes(x = sampling, y = predict(ThalaCux21_model)))
## ThalaCux 21 Low
ThalaCux21Lr1<- tbl %>%
filter(wavelength1 %in% c('440')) %>%
mutate(treatmentID = paste(species, temperature, nut, sep = '_'),
log = log(value)) %>%
filter(treatmentID == 'ThalaCux_21_Low') %>%
filter(sampling <sampling_death)
N0s<- median(ThalaCux21Lr1$value[ThalaCux21Lr1$sampling==1] )#Set the start OD-value (Day=1)
Daymax<-max(ThalaCux21Lr1$sampling) #Select the maximum number of days (time of incubation)
Ks<-median(ThalaCux21Lr1$value[ThalaCux21Lr1$sampling==Daymax])#Estimated value for K (Carrying Capacity) = Time of incubation
rs<-0.13#Estimated growth rate (r)
ThalaCux21_model <- nls(value ~ K*N0*exp(r*sampling)/(K+N0*(exp(r*sampling)-1)),
start=list(N0=N0s,K=Ks,r=rs),
data = ThalaCux21Lr1)
summary(ThalaCux21_model)
sum_modeL <-summary(ThalaCux21_model)
N0 <- sum_modeL$coefficients[1,1] #N0
K  <- sum_modeL$coefficients[2,1] #K
r  <- sum_modeL$coefficients[3,1] #r
pK  <- sum_modeL$coefficients[2,4] #pK
pr  <- sum_modeL$coefficients[3,4] #pr
ThalaCux21Lr1 $N0 <- N0
ThalaCux21Lr1 $K <- K
ThalaCux21Lr1 $r <- r
ThalaCux21Lr1 $pK <- pK
ThalaCux21Lr1 $pr <- pr
ggplot(ThalaCux21Lr1, aes(x = sampling, y = value))+
geom_point()+
geom_line(data = ThalaCux21Lr1, aes(x = sampling, y = predict(ThalaCux21_model)))
## ThalaCux 24 HI
ThalaCux24r1<- tbl %>%
filter(wavelength1 %in% c('440')) %>%
mutate(treatmentID = paste(species, temperature, nut, sep = '_'),
log = log(value)) %>%
filter(treatmentID == 'ThalaCux_24_HI') %>%
filter(sampling <=sampling_death)
N0s<- median(ThalaCux24r1$value[ThalaCux24r1$sampling==1] )#Set the start OD-value (Day=1)
Daymax<-max(ThalaCux24r1$sampling) #Select the maximum number of days (time of incubation)
Ks<-median(ThalaCux24r1$value[ThalaCux24r1$sampling==Daymax])#Estimated value for K (Carrying Capacity) = Time of incubation
rs<-0.8#Estimated growth rate (r)
ThalaCux24_model <- nls(value ~ K*N0*exp(r*sampling)/(K+N0*(exp(r*sampling)-1)),
start=list(N0=N0s,K=Ks,r=rs),
data = ThalaCux24r1)
summary(ThalaCux24_model)
sum_modeL <-summary(ThalaCux24_model)
N0 <- sum_modeL$coefficients[1,1] #N0
K  <- sum_modeL$coefficients[2,1] #K
r  <- sum_modeL$coefficients[3,1] #r
pK  <- sum_modeL$coefficients[2,4] #pK
pr  <- sum_modeL$coefficients[3,4] #pr
ThalaCux24r1 $N0 <- N0
ThalaCux24r1 $K <- K
ThalaCux24r1 $r <- r
ThalaCux24r1 $pK <- pK
ThalaCux24r1 $pr <- pr
ggplot(ThalaCux24r1, aes(x = sampling, y = value))+
geom_point()+
geom_line(data = ThalaCux24r1, aes(x = sampling, y = predict(ThalaCux24_model)))
## ThalaCux 24 Low
ThalaCux24Lr1<- tbl %>%
filter(wavelength1 %in% c('440')) %>%
mutate(treatmentID = paste(species, temperature, nut, sep = '_'),
log = log(value)) %>%
filter(treatmentID == 'ThalaCux_24_Low') %>%
filter(sampling <=sampling_death)
N0s<- median(ThalaCux24Lr1$value[ThalaCux24Lr1$sampling==1] )#Set the start OD-value (Day=1)
Daymax<-max(ThalaCux24Lr1$sampling) #Select the maximum number of days (time of incubation)
Ks<-median(ThalaCux24Lr1$value[ThalaCux24Lr1$sampling==Daymax])#Estimated value for K (Carrying Capacity) = Time of incubation
rs<-0.13#Estimated growth rate (r)
ThalaCux24_model <- nls(value ~ K*N0*exp(r*sampling)/(K+N0*(exp(r*sampling)-1)),
start=list(N0=N0s,K=Ks,r=rs),
data = ThalaCux24Lr1)
summary(ThalaCux24_model)
sum_modeL <-summary(ThalaCux24_model)
N0 <- sum_modeL$coefficients[1,1] #N0
K  <- sum_modeL$coefficients[2,1] #K
r  <- sum_modeL$coefficients[3,1] #r
pK  <- sum_modeL$coefficients[2,4] #pK
pr  <- sum_modeL$coefficients[3,4] #pr
ThalaCux24Lr1 $N0 <- N0
ThalaCux24Lr1 $K <- K
ThalaCux24Lr1 $r <- r
ThalaCux24Lr1 $pK <- pK
ThalaCux24Lr1 $pr <- pr
ggplot(ThalaCux24Lr1, aes(x = sampling, y = value))+
geom_point()+
geom_line(data = ThalaCux24Lr1, aes(x = sampling, y = predict(ThalaCux24_model)))
## ThalaCux 27 HI
ThalaCux27r1<- tbl %>%
filter(wavelength1 %in% c('440')) %>%
mutate(treatmentID = paste(species, temperature, nut, sep = '_'),
log = log(value)) %>%
filter(treatmentID == 'ThalaCux_27_HI') %>%
filter(sampling <sampling_death-5)
N0s<- median(ThalaCux27r1$value[ThalaCux27r1$sampling==1] )#Set the start OD-value (Day=1)
Daymax<-max(ThalaCux27r1$sampling) #Select the maximum number of days (time of incubation)
Ks<-median(ThalaCux27r1$value[ThalaCux27r1$sampling==Daymax])#Estimated value for K (Carrying Capacity) = Time of incubation
rs<-0.13#Estimated growth rate (r)
ThalaCux27_model <- nls(value ~ K*N0*exp(r*sampling)/(K+N0*(exp(r*sampling)-1)),
start=list(N0=N0s,K=Ks,r=rs),
data = ThalaCux27r1)
summary(ThalaCux27_model)
sum_modeL <-summary(ThalaCux27_model)
N0 <- sum_modeL$coefficients[1,1] #N0
K  <- sum_modeL$coefficients[2,1] #K
r  <- sum_modeL$coefficients[3,1] #r
pK  <- sum_modeL$coefficients[2,4] #pK
pr  <- sum_modeL$coefficients[3,4] #pr
ThalaCux27r1 $N0 <- N0
ThalaCux27r1 $K <- K
ThalaCux27r1 $r <- r
ThalaCux27r1 $pK <- pK
ThalaCux27r1 $pr <- pr
ggplot(ThalaCux27r1, aes(x = sampling, y = value, color = rep))+
geom_point()+
geom_line(data = ThalaCux27r1, aes(x = sampling, y = predict(ThalaCux27_model)))
## ThalaCux 27 Low
ThalaCux27Lr1<- tbl %>%
filter(wavelength1 %in% c('440')) %>%
mutate(treatmentID = paste(species, temperature, nut, sep = '_'),
log = log(value)) %>%
filter(treatmentID == 'ThalaCux_27_Low') %>%
filter(sampling <sampling_death-5)
N0s<- median(ThalaCux27Lr1$value[ThalaCux27Lr1$sampling==1] )#Set the start OD-value (Day=1)
Daymax<-max(ThalaCux27Lr1$sampling) #Select the maximum number of days (time of incubation)
Ks<-median(ThalaCux27Lr1$value[ThalaCux27Lr1$sampling==Daymax])#Estimated value for K (Carrying Capacity) = Time of incubation
rs<-0.3#Estimated growth rate (r)
ThalaCux27_model <- nls(value ~ K*N0*exp(r*sampling)/(K+N0*(exp(r*sampling)-1)),
start=list(N0=N0s,K=Ks,r=rs),
data = ThalaCux27Lr1)
summary(ThalaCux27_model)
sum_modeL <-summary(ThalaCux27_model)
N0 <- sum_modeL$coefficients[1,1] #N0
K  <- sum_modeL$coefficients[2,1] #K
r  <- sum_modeL$coefficients[3,1] #r
pK  <- sum_modeL$coefficients[2,4] #pK
pr  <- sum_modeL$coefficients[3,4] #pr
ThalaCux27Lr1 $N0 <- N0
ThalaCux27Lr1 $K <- K
ThalaCux27Lr1 $r <- r
ThalaCux27Lr1 $pK <- pK
ThalaCux27Lr1 $pr <- pr
ggplot(ThalaCux27Lr1, aes(x = sampling, y = value))+
geom_point()+
geom_line(data = ThalaCux27Lr1, aes(x = sampling, y = predict(ThalaCux27_model)))
## ThalaCux 27 Low
ThalaCux27Lr1<- tbl %>%
filter(wavelength1 %in% c('440')) %>%
mutate(treatmentID = paste(species, temperature, nut, sep = '_'),
log = log(value)) %>%
filter(treatmentID == 'ThalaCux_27_Low') %>%
filter(sampling <sampling_death-5) %>%
filter(value < 0.06)
N0s<- median(ThalaCux27Lr1$value[ThalaCux27Lr1$sampling==1] )#Set the start OD-value (Day=1)
Daymax<-max(ThalaCux27Lr1$sampling) #Select the maximum number of days (time of incubation)
Ks<-median(ThalaCux27Lr1$value[ThalaCux27Lr1$sampling==Daymax])#Estimated value for K (Carrying Capacity) = Time of incubation
rs<-0.3#Estimated growth rate (r)
ThalaCux27_model <- nls(value ~ K*N0*exp(r*sampling)/(K+N0*(exp(r*sampling)-1)),
start=list(N0=N0s,K=Ks,r=rs),
data = ThalaCux27Lr1)
summary(ThalaCux27_model)
sum_modeL <-summary(ThalaCux27_model)
N0 <- sum_modeL$coefficients[1,1] #N0
K  <- sum_modeL$coefficients[2,1] #K
r  <- sum_modeL$coefficients[3,1] #r
pK  <- sum_modeL$coefficients[2,4] #pK
pr  <- sum_modeL$coefficients[3,4] #pr
ThalaCux27Lr1 $N0 <- N0
ThalaCux27Lr1 $K <- K
ThalaCux27Lr1 $r <- r
ThalaCux27Lr1 $pK <- pK
ThalaCux27Lr1 $pr <- pr
ggplot(ThalaCux27Lr1, aes(x = sampling, y = value))+
geom_point()+
geom_line(data = ThalaCux27Lr1, aes(x = sampling, y = predict(ThalaCux27_model)))
ThalaCuxall <- rbind(ThalaCux27Lr1, ThalaCux27r1,ThalaCux24Lr1, ThalaCux24r1,ThalaCux21Lr1, ThalaCux21r1,
ThalaCux18Lr1, ThalaCux18r1,ThalaCux15Lr1, ThalaCux15r1,ThalaCux12Lr1, ThalaCux12r1,
ThalaCux9Lr1, ThalaCux9r1,ThalaCux6Lr1, ThalaCux6r1)
ggplot(ThalaCuxall, aes(x = temperature, y = r, color = nut, group = nut))+
geom_point()+
geom_line()
ggsave(plot = last_plot(), 'ThalaCux_r_temp.png')
rm(list=ls())#remove all environment data
library(tidyverse)
library(mgcv) #gam package
library(growthrates)
library(readxl)
##Arbeitsverzeichnis setzen (die folgende Zeile setzt das Arbeitsverzeichnis an den Ort des R-Skriptes)
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
#### import all data ####
AllSamplingsCombined <- read_delim("AllSamplingsDistinct.csv",
";", escape_double = FALSE, locale = locale(decimal_mark = ","), trim_ws = TRUE)#%>%
#select(-X1)
AllBlanks <- read_csv("AllBlanks.csv") %>%
filter(treatment_ID != 'MQ') %>%
select(treatment_ID, value, temperature, plate, wavelength1) %>%
rename(Blank = value)
TPC_Masters_ID <- read_excel("~/Desktop/phD/Experiments/CharlyTPC2021/DataForAnalysis/TPC_Masters_ID.xlsx") %>%
select(-death, -comment)
TPC_Masters_ID2 <- read_excel("~/Desktop/phD/Experiments/CharlyTPC2021/DataForAnalysis/TPC_Masters_ID.xlsx", sheet = "TPC_2NEW") %>%
select(-ID, -death, -comment, -wellplate, -Ansatz) %>%
mutate(ID = paste(SpeciesName, temperature, nut, rep, Sample, sep = ' ')) %>%
rename(species = SpeciesName)
TPC_Master <- rbind(TPC_Masters_ID, TPC_Masters_ID2) %>%
filter(!species %in% c('Mix', 'pulse'))
#merge all data
tbl<-left_join(AllSamplingsCombined, TPC_Master, by = c('nut', 'temperature', 'rep', 'species')) %>%
mutate(treatment_ID = paste(species, nut, rep, sep = ' ')) %>%
rename(raw = value)
which(is.na(tbl$sampling_death))
str(tbl)
tbl<-merge(tbl, AllBlanks, by = c('plate', 'treatment_ID', 'temperature', 'wavelength1')) %>%
mutate(value = raw-Blank) %>%
mutate(sampling_death = as.numeric(sampling_death)) %>%
drop_na(sampling_death) %>%
select(-"...1")%>%
distinct(treatment_ID, temperature, wavelength1, method, fileName,ID,  sampling, species, nut, rep,value,sampling_death )
#### Calculation of growthrates ####
data0 <- tbl %>%
filter(wavelength1 == 440 & nut == 'HI'& species %in% c('DityCux', 'ThalaCux', 'Asterio2', 'Rhizo', 'Guido')) %>%
filter(value >0 & value <1) %>%
mutate(sampling = as.numeric(paste(ifelse(species == 'Asterio2', sampling-6, sampling))))
str(data0)
data0 %>%
filter(species == 'Rhizo') %>%
ggplot(.,aes(x =sampling, y = value))+
geom_point()+
facet_wrap(~temperature, scale = 'free_y')+
theme_bw()
data<-data0%>%
group_by(ID)%>%
arrange(ID, sampling)%>%
filter(sampling < sampling_death-5)%>%
filter(n()>4)%>%
do(model=fit_easylinear(.$sampling,.$value))%>%   #growth rate model
mutate(r=summary(model)$coefficient[2,1],
pvalue=summary(model)$coefficient[2,4])%>%  #gives you the slope (r) and pvalue
mutate(id = ID) %>%
separate(ID, into = c('species', 'temp', 'nut', 'rep', 'sample'), sep = ' ') %>%
select(-model, -nut)
#remove outliers
Asterio <- subset(data,  species == 'Asterio2') %>%
filter(r>0 & r<0.81)
data_subset <- data %>%
filter(species != 'Asterio2') %>%
filter(r>0 & r < 0.6) %>%
bind_rows(., Asterio) %>%
mutate(temp = as.numeric(temp)) %>%
arrange(species, temp)
View(data_subset)
data<-data0%>%
group_by(ID)%>%
arrange(ID, sampling)%>%
filter(sampling < sampling_death-5)%>%
filter(n()>4)%>%
do(model=fit_easylinear(.$sampling,.$value))%>%   #growth rate model
mutate(r=summary(model)$coefficient[2,1],
pvalue=summary(model)$coefficient[2,4])%>%  #gives you the slope (r) and pvalue
mutate(id = ID) %>%
separate(ID, into = c('species', 'temp', 'nut', 'rep', 'sample'), sep = ' ')
#remove outliers
Asterio <- subset(data,  species == 'Asterio2') %>%
filter(r>0 & r<0.81)
data_subset <- data %>%
filter(species != 'Asterio2') %>%
filter(r>0 & r < 0.6) %>%
bind_rows(., Asterio) %>%
mutate(temp = as.numeric(temp)) %>%
arrange(species, temp)
#save linar growth rates
saveRDS(data_subset, file = 'LinearGrowthData.RDS')
data_subset %>%
ggplot(., aes(x = temp, y = r, color = nut))+
geom_point()+
geom_smooth()+
facet_grid(~species)
data0 <- tbl %>%
filter(wavelength1 == 440 & nut == 'LOW'& species %in% c('DityCux', 'ThalaCux', 'Asterio2', 'Rhizo', 'Guido')) %>%
filter(value >0 & value <1) %>%
mutate(sampling = as.numeric(paste(ifelse(species == 'Asterio2', sampling-6, sampling))))
str(data0)
data0 %>%
filter(species == 'Rhizo') %>%
ggplot(.,aes(x =sampling, y = value))+
geom_point()+
facet_wrap(~temperature, scale = 'free_y')+
theme_bw()
data<-data0%>%
group_by(ID)%>%
arrange(ID, sampling)%>%
filter(sampling < sampling_death-5)%>%
filter(n()>4)%>%
do(model=fit_easylinear(.$sampling,.$value))%>%   #growth rate model
mutate(r=summary(model)$coefficient[2,1],
pvalue=summary(model)$coefficient[2,4])%>%  #gives you the slope (r) and pvalue
mutate(id = ID) %>%
separate(ID, into = c('species', 'temp', 'nut', 'rep', 'sample'), sep = ' ')
data0 <- tbl %>%
filter(wavelength1 == 440 & nut == 'LOW'& species %in% c('DityCux', 'ThalaCux', 'Asterio2', 'Rhizo', 'Guido')) %>%
filter(value >0 & value <1) %>%
mutate(sampling = as.numeric(paste(ifelse(species == 'Asterio2', sampling-6, sampling))))
str(data0)
##Arbeitsverzeichnis setzen (die folgende Zeile setzt das Arbeitsverzeichnis an den Ort des R-Skriptes)
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
#### import all data ####
AllSamplingsCombined <- read_delim("AllSamplingsDistinct.csv",
";", escape_double = FALSE, locale = locale(decimal_mark = ","), trim_ws = TRUE)#%>%
#select(-X1)
AllBlanks <- read_csv("AllBlanks.csv") %>%
filter(treatment_ID != 'MQ') %>%
select(treatment_ID, value, temperature, plate, wavelength1) %>%
rename(Blank = value)
TPC_Masters_ID <- read_excel("~/Desktop/phD/Experiments/CharlyTPC2021/DataForAnalysis/TPC_Masters_ID.xlsx") %>%
select(-death, -comment)
TPC_Masters_ID2 <- read_excel("~/Desktop/phD/Experiments/CharlyTPC2021/DataForAnalysis/TPC_Masters_ID.xlsx", sheet = "TPC_2NEW") %>%
select(-ID, -death, -comment, -wellplate, -Ansatz) %>%
mutate(ID = paste(SpeciesName, temperature, nut, rep, Sample, sep = ' ')) %>%
rename(species = SpeciesName)
TPC_Master <- rbind(TPC_Masters_ID, TPC_Masters_ID2) %>%
filter(!species %in% c('Mix', 'pulse'))
#merge all data
tbl<-left_join(AllSamplingsCombined, TPC_Master, by = c('nut', 'temperature', 'rep', 'species')) %>%
mutate(treatment_ID = paste(species, nut, rep, sep = ' ')) %>%
rename(raw = value)
which(is.na(tbl$sampling_death))
str(tbl)
tbl<-merge(tbl, AllBlanks, by = c('plate', 'treatment_ID', 'temperature', 'wavelength1')) %>%
mutate(value = raw-Blank) %>%
mutate(sampling_death = as.numeric(sampling_death)) %>%
drop_na(sampling_death) %>%
select(-"...1")%>%
distinct(treatment_ID, temperature, wavelength1, method, fileName,ID,  sampling, species, nut, rep,value,sampling_death )
View(tbl)
data0 <- tbl %>%
filter(wavelength1 == 440 & nut == 'Low'& species %in% c('DityCux', 'ThalaCux', 'Asterio2', 'Rhizo', 'Guido')) %>%
filter(value >0 & value <1) %>%
mutate(sampling = as.numeric(paste(ifelse(species == 'Asterio2', sampling-6, sampling))))
str(data0)
data0 %>%
filter(species == 'Rhizo') %>%
ggplot(.,aes(x =sampling, y = value))+
geom_point()+
facet_wrap(~temperature, scale = 'free_y')+
theme_bw()
data<-data0%>%
group_by(ID)%>%
arrange(ID, sampling)%>%
filter(sampling < sampling_death-5)%>%
filter(n()>4)%>%
do(model=fit_easylinear(.$sampling,.$value))%>%   #growth rate model
mutate(r=summary(model)$coefficient[2,1],
pvalue=summary(model)$coefficient[2,4])%>%  #gives you the slope (r) and pvalue
mutate(id = ID) %>%
separate(ID, into = c('species', 'temp', 'nut', 'rep', 'sample'), sep = ' ')
data<-data0%>%
group_by(ID)%>%
arrange(ID, sampling)%>%
filter(sampling < sampling_death-5)%>%
filter(n()>4)%>%
do(model=fit_easylinear(.$sampling,.$value))#%>%   #growth rate model
View(data)
data<-data0%>%
group_by(ID)%>%
arrange(ID, sampling)%>%
filter(sampling < sampling_death-5)%>%
filter(n()>4)%>%
do(model=fit_easylinear(.$sampling,.$value))%>%   #growth rate model
mutate(r=summary(model)$coefficient[2,1],
pvalue=summary(model)$coefficient[2,4])%>%  #gives you the slope (r) and pvalue
mutate(id = ID) %>%
separate(ID, into = c('species', 'temp', 'nut', 'rep', 'sample'), sep = ' ')
summary(model)$coefficient[2,4]
