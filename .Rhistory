scale_shape_manual(values= shape_values)+
facet_wrap(~N, scales = 'free_x', labeller = labeller(N = labels_plot245))+
theme_bw()+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank()) +
theme(axis.title.x = element_text(size = 14,face = "plain", colour = "black", vjust = 0),
axis.text.x = element_text(size = 10,  colour = "black", angle = 0, vjust = 0.5)) +
theme(axis.title.y = element_text(size = 14, face = "plain", colour = "black", vjust = 1.8),
axis.text.y = element_text(size = 10,  colour = "black", angle = 0, hjust = 0.4)) +
theme(strip.background =element_rect(),
strip.text.x  = element_text(size = 12))+
theme(legend.position = 'right',
legend.key.size = unit(1, 'cm'),
legend.title = element_text(size=16),
legend.text = element_text(size=14))
guides(color = guide_legend(override.aes = list(size = 3.5)))
plot245<- allNetBiodiv %>%
group_by( combination, temp, N) %>%
summarise(mean.effect = mean(NetEffect, na.rm = T),
sd.effect = sd(NetEffect,na.rm = T),
se.effect = sd.effect/sqrt(n()))%>%
ggplot(., aes(x = combination, y = mean.effect,color = temp, shape = temp))+
geom_hline(yintercept = 0, color = 'darkgrey')+
geom_errorbar(aes(ymin = mean.effect - se.effect, ymax = mean.effect +se.effect), width = .3, alpha = .7 )+
geom_point(size = 2.5, alpha = 0.9)+
labs(x = 'Species Combination', y = expression(Net~Biodiversity~Effect~on~Functioning), color = 'Treatment', shape = 'Treatment')+
scale_color_manual(values= temp1Palette)+
scale_shape_manual(values= shape_values)+
facet_wrap(~N, scales = 'free_x', labeller = labeller(N = labels_plot245))+
theme_bw()+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank()) +
theme(axis.title.x = element_text(size = 14,face = "plain", colour = "black", vjust = 0),
axis.text.x = element_text(size = 10,  colour = "black", angle = 0, vjust = 0.5)) +
theme(axis.title.y = element_text(size = 14, face = "plain", colour = "black", vjust = 1.8),
axis.text.y = element_text(size = 10,  colour = "black", angle = 0, hjust = 0.4)) +
theme(strip.background =element_rect(),
strip.text.x  = element_text(size = 12))+
theme(legend.position = 'right',
legend.key.size = unit(1, 'cm'),
legend.title = element_text(size=16),
legend.text = element_text(size=14))+
guides(color = guide_legend(override.aes = list(size = 3.5)))
plot245
legend_f<- get_legend(plot245)
nbef <- cowplot::plot_grid( NBE+theme(legend.position = 'none'),
plot245+theme(legend.position = 'none'),
legend_f,
hjust = -0.05,
ncol = 3,
labels = c('(c)', '(d)'),
rel_widths = c( 2/7,4/7,1/7))
p1<-d3%>%
group_by(N, temp,combination) %>%
summarise(mean.total.DRR = mean(NBE, na.rm = T),
sd = sd(NBE,na.rm = T),
se = sd/sqrt(n()))%>%
mutate(label = paste(ifelse( N == 2, '2 species', ifelse(N == 4, '4 species', '5 species'))))%>%
ggplot(., aes(x = combination, y = mean.total.DRR,color = temp, shape = temp))+
geom_hline(yintercept = 0, color = 'darkgrey')+
geom_point(size = 2.5, alpha = 0.9)+
geom_errorbar(aes(ymin = mean.total.DRR - se, ymax = mean.total.DRR +se), width = .3, alpha = .7)+
labs(x = 'Species Combination', y = 'Net Biodiversity Effect on Stability', color = 'Treatment', shape = 'Treatment')+
# scale_x_continuous(limits = c(0.5,5.5), breaks = c(2,4,5))+
scale_colour_brewer(palette = "Set1")+
facet_grid(~label, scales = 'free')+
theme_bw()+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank()) +
theme(axis.title.x = element_text(size = 14,face = "plain", colour = "black", vjust = 0),
axis.text.x = element_text(size = 10,  colour = "black", angle = 0, vjust = 0.5)) +
theme(axis.title.y = element_text(size = 14, face = "plain", colour = "black", vjust = 1.8),
axis.text.y = element_text(size = 10,  colour = "black", angle = 0, hjust = 0.4)) +
theme(strip.background =element_rect(),
strip.text.x  = element_text(size = 12))+
guides(color = guide_legend(override.aes = list(size = 3.5)))+
theme(legend.position = 'right',
legend.key.size = unit(1, 'cm'),
legend.title = element_text(size=16),
legend.text = element_text(size=14))
p1
legendb<-get_legend(p1)
p2 <- d3%>%
group_by(N, temp) %>%
summarise(mean.total.DRR = mean(NBE, na.rm = T),
sd = sd(NBE,na.rm = T),
se = sd/sqrt(n()))%>%
ggplot(.)+
geom_hline(yintercept = 0, color = 'darkgrey')+
geom_point(aes(x = as.factor(N), y = mean.total.DRR, color=temp, shape=temp),size = 3.5, alpha = 0.9)+
geom_errorbar(aes(x=as.factor(N),ymin = mean.total.DRR - se, ymax = mean.total.DRR +se, col=temp), alpha = 0.7, width = .1)+
labs(x = 'Species Richness', y = 'Net Biodiversity Effect on Stability', color = 'Treatment', shape = 'Treatment')+
scale_colour_brewer(palette = "Set1")+
theme_bw()+
theme(legend.position = 'none',
panel.grid.major=element_blank(),panel.grid.minor=element_blank()) +
theme(axis.title.x = element_text(size = 14,face = "plain", colour = "black", vjust = 0),
axis.text.x = element_text(size = 10,  colour = "black", angle = 0, vjust = 0.5)) +
theme(axis.title.y = element_text(size = 14, face = "plain", colour = "black", vjust = 1.8),
axis.text.y = element_text(size = 10,  colour = "black", angle = 0, hjust = 0.4)) +
theme(strip.background =element_rect(),
strip.text.x  = element_text(size = 12))+
guides(color = guide_legend(override.aes = list(size = 3.5)))
p2
nbes <- cowplot::plot_grid( p2,p1+theme(legend.position = 'none'),legendb,hjust = -0.05, labels = c('(a)', '(b)'), ncol = 3,rel_widths = c( 2/7,4/7,1/7), rel_heights = c(10,0.2))
#run 05_NBE_HectorLoreau_NetBiodivEffect through
source(here("code/05_NBE_HectorLoreau_NetBiodivEffect.R"))
(nbes/nbef)
ggsave(plot = last_plot(), file = here('output/Fig3_NBE_NBES.png'), width = 14, height = 9)
plot245<- allNetBiodiv %>%
group_by( combination, temp, N) %>%
summarise(mean.effect = mean(NetEffect, na.rm = T),
sd.effect = sd(NetEffect,na.rm = T),
se.effect = sd.effect/sqrt(n()))%>%
ggplot(., aes(x = combination, y = mean.effect,color = temp, shape = temp))+
geom_hline(yintercept = 0, color = 'darkgrey')+
geom_errorbar(aes(ymin = mean.effect - se.effect, ymax = mean.effect +se.effect), width = .3, alpha = .7 )+
geom_point(size = 2.5, alpha = 0.9)+
labs(x = 'Species Combination', y = expression(Net~Biodiversity~Effect~on~Functioning), color = 'Treatment', shape = 'Treatment')+
scale_color_manual(values= temp1Palette)+
scale_shape_manual(values= shape_values)+
facet_wrap(~N, scales = 'free_x', labeller = labeller(N = labels_plot245))+
theme_bw()+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank()) +
theme(axis.title.x = element_text(size = 14,face = "plain", colour = "black", vjust = 0),
axis.text.x = element_text(size = 10,  colour = "black", angle = 0, vjust = 0.5)) +
theme(axis.title.y = element_text(size = 14, face = "plain", colour = "black", vjust = 1.8),
axis.text.y = element_text(size = 10,  colour = "black", angle = 0, hjust = 0.4)) +
theme(strip.background =element_rect(),
strip.text.x  = element_text(size = 12))+
theme(legend.position = 'right',
legend.key.size = unit(1, 'cm'),
legend.title = element_text(size=16),
legend.text = element_text(size=14))+
guides(color = guide_legend(override.aes = list(size = 3.5)))
plot245
legend_f<- get_legend(plot245)
nbef <- cowplot::plot_grid( NBE+theme(legend.position = 'none'),
plot245+theme(legend.position = 'none'),
legend_f,
hjust = -0.05,
ncol = 3,
labels = c('(c)', '(d)'),
rel_widths = c( 2/7,4/7,1/7))
#run 05_NBE_HectorLoreau_NetBiodivEffect through
source(here("code/05_NBE_HectorLoreau_NetBiodivEffect.R"))
(nbes/nbef)
ggsave(plot = last_plot(), file = here('output/Fig3_NBE_NBES.png'), width = 15, height = 9)
dev.off()
(nbes/nbef)
ggsave(plot = last_plot(), file = here('output/Fig3_NBE_NBES.png'), width = 15, height = 9)
nbes <- cowplot::plot_grid( p2,p1+theme(legend.position = 'none'),legendb,hjust = -0.05, labels = c('(a)', '(b)'), ncol = 3,rel_widths = c( 2/7,4/7,1/7), rel_heights = c(10,0.2))
nbes <- cowplot::plot_grid( p2,p1+theme(legend.position = 'none'),legendb,hjust = -0.05, labels = c('(a)', '(b)'), ncol = 3,rel_widths = c( 2/7,4/7,1/7), rel_heights = c(10,0.2))
#run 05_NBE_HectorLoreau_NetBiodivEffect through
source(here("code/05_NBE_HectorLoreau_NetBiodivEffect.R"))
(nbes/nbef)
ggsave(plot = last_plot(), file = here('output/Fig3_NBE_NBES.png'), width = 15, height = 9)
p1<-d3%>%
group_by(N, temp,combination) %>%
summarise(mean.total.DRR = mean(NBE, na.rm = T),
sd = sd(NBE,na.rm = T),
se = sd/sqrt(n()))%>%
mutate(label = paste(ifelse( N == 2, '2 species', ifelse(N == 4, '4 species', '5 species'))))%>%
ggplot(., aes(x = combination, y = mean.total.DRR,color = temp, shape = temp))+
geom_hline(yintercept = 0, color = 'darkgrey')+
geom_point(size = 2.5, alpha = 0.9)+
geom_errorbar(aes(ymin = mean.total.DRR - se, ymax = mean.total.DRR +se), width = .3, alpha = .7)+
labs(x = 'Species Combination', y = 'Net Biodiversity Effect on Stability', color = 'Treatment', shape = 'Treatment')+
# scale_x_continuous(limits = c(0.5,5.5), breaks = c(2,4,5))+
scale_colour_brewer(palette = "Set1")+
facet_grid(~label, scales = 'free')+
theme_bw()+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank()) +
theme(axis.title.x = element_text(size = 14,face = "plain", colour = "black", vjust = 0),
axis.text.x = element_text(size = 10,  colour = "black", angle = 0, vjust = 0.5)) +
theme(axis.title.y = element_text(size = 14, face = "plain", colour = "black", vjust = 1.8),
axis.text.y = element_text(size = 10,  colour = "black", angle = 0, hjust = 0.4)) +
theme(strip.background =element_rect(),
strip.text.x  = element_text(size = 12))+
guides(color = guide_legend(override.aes = list(size = 3.5)))+
theme(legend.position = 'right',
legend.key.size = unit(1, 'cm'),
legend.title = element_text(size=14),
legend.text = element_text(size=12))
p1
legendb<-get_legend(p1)
p2 <- d3%>%
group_by(N, temp) %>%
summarise(mean.total.DRR = mean(NBE, na.rm = T),
sd = sd(NBE,na.rm = T),
se = sd/sqrt(n()))%>%
ggplot(.)+
geom_hline(yintercept = 0, color = 'darkgrey')+
geom_point(aes(x = as.factor(N), y = mean.total.DRR, color=temp, shape=temp),size = 3.5, alpha = 0.9)+
geom_errorbar(aes(x=as.factor(N),ymin = mean.total.DRR - se, ymax = mean.total.DRR +se, col=temp), alpha = 0.7, width = .1)+
labs(x = 'Species Richness', y = 'Net Biodiversity Effect on Stability', color = 'Treatment', shape = 'Treatment')+
scale_colour_brewer(palette = "Set1")+
theme_bw()+
theme(legend.position = 'none',
panel.grid.major=element_blank(),panel.grid.minor=element_blank()) +
theme(axis.title.x = element_text(size = 14,face = "plain", colour = "black", vjust = 0),
axis.text.x = element_text(size = 10,  colour = "black", angle = 0, vjust = 0.5)) +
theme(axis.title.y = element_text(size = 14, face = "plain", colour = "black", vjust = 1.8),
axis.text.y = element_text(size = 10,  colour = "black", angle = 0, hjust = 0.4)) +
theme(strip.background =element_rect(),
strip.text.x  = element_text(size = 12))+
guides(color = guide_legend(override.aes = list(size = 3.5)))
p2
nbes <- cowplot::plot_grid( p2,p1+theme(legend.position = 'none'),legendb,hjust = -0.05, labels = c('(a)', '(b)'), ncol = 3,rel_widths = c( 2/7,4/7,1/7), rel_heights = c(10,0.2))
plot245<- allNetBiodiv %>%
group_by( combination, temp, N) %>%
summarise(mean.effect = mean(NetEffect, na.rm = T),
sd.effect = sd(NetEffect,na.rm = T),
se.effect = sd.effect/sqrt(n()))%>%
ggplot(., aes(x = combination, y = mean.effect,color = temp, shape = temp))+
geom_hline(yintercept = 0, color = 'darkgrey')+
geom_errorbar(aes(ymin = mean.effect - se.effect, ymax = mean.effect +se.effect), width = .3, alpha = .7 )+
geom_point(size = 2.5, alpha = 0.9)+
labs(x = 'Species Combination', y = expression(Net~Biodiversity~Effect~on~Functioning), color = 'Treatment', shape = 'Treatment')+
scale_color_manual(values= temp1Palette)+
scale_shape_manual(values= shape_values)+
facet_wrap(~N, scales = 'free_x', labeller = labeller(N = labels_plot245))+
theme_bw()+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank()) +
theme(axis.title.x = element_text(size = 14,face = "plain", colour = "black", vjust = 0),
axis.text.x = element_text(size = 10,  colour = "black", angle = 0, vjust = 0.5)) +
theme(axis.title.y = element_text(size = 14, face = "plain", colour = "black", vjust = 1.8),
axis.text.y = element_text(size = 10,  colour = "black", angle = 0, hjust = 0.4)) +
theme(strip.background =element_rect(),
strip.text.x  = element_text(size = 12))+
theme(legend.position = 'right',
legend.key.size = unit(1, 'cm'),
legend.title = element_text(size=14),
legend.text = element_text(size=12))+
guides(color = guide_legend(override.aes = list(size = 3.5)))
plot245
legend_f<- get_legend(plot245)
nbef <- cowplot::plot_grid( NBE+theme(legend.position = 'none'),
plot245+theme(legend.position = 'none'),
legend_f,
hjust = -0.05,
ncol = 3,
labels = c('(c)', '(d)'),
rel_widths = c( 2/7,4/7,1/7))
NBE1 <- allNetBiodiv%>%
group_by( temp, N) %>%
mutate(mean.effect = mean(NetEffect, na.rm = T),
sd.effect = sd(NetEffect,na.rm = T),
se.effect = sd.effect/sqrt(n()))%>%
ggplot(. )+
geom_hline(yintercept = 0, color = 'darkgrey')+
geom_point(aes(x = N, y = NetEffect,color = temp), size = 1, shape = 1, alpha = 0.2)+
geom_errorbar(aes(x = N, y = mean.effect,ymin = mean.effect - se.effect, ymax = mean.effect +se.effect,color = temp), width = .3, alpha = .5 )+
geom_point(aes(x = N, y = mean.effect,color = temp, shape = temp), size = 2.5, alpha = 0.7)+
labs(x = 'Species Richness', y = 'Net Biodiversity effect', color = 'Treatment', shape = 'Treatment')+
scale_x_continuous(limits = c(1,5.5), breaks = c(2,4,5))+
scale_color_manual(values= temp1Palette)+
scale_shape_manual(values= shape_values)+
theme_bw()+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank()) +
theme(axis.title.x = element_text(size = 16,face = "plain", colour = "black", vjust = 0),
axis.text.x = element_text(size = 10,  colour = "black", angle = 0, vjust = 0.5)) +
theme(axis.title.y = element_text(size = 16, face = "plain", colour = "black", vjust = 1.8),
axis.text.y = element_text(size = 10,  colour = "black", angle = 0, hjust = 0.4)) +
theme(strip.background =element_rect(),
strip.text.x  = element_text(size = 12))+
guides(color = guide_legend(override.aes = list(size = 3.5)))
#run 05_NBE_HectorLoreau_NetBiodivEffect through
source(here("code/05_NBE_HectorLoreau_NetBiodivEffect.R"))
(nbes/nbef)
ggsave(plot = last_plot(), file = here('output/Fig3_NBE_NBES.png'), width = 15, height = 9)
dev.off()
plot245<- allNetBiodiv %>%
group_by( combination, temp, N) %>%
summarise(mean.effect = mean(NetEffect, na.rm = T),
sd.effect = sd(NetEffect,na.rm = T),
se.effect = sd.effect/sqrt(n()))%>%
ggplot(., aes(x = combination, y = mean.effect,color = temp, shape = temp))+
geom_hline(yintercept = 0, color = 'darkgrey')+
geom_errorbar(aes(ymin = mean.effect - se.effect, ymax = mean.effect +se.effect), width = .3, alpha = .7 )+
geom_point(size = 2.5, alpha = 0.9)+
labs(x = 'Species Combination', y = expression(Net~Biodiversity~Effect~on~Functioning), color = 'Treatment', shape = 'Treatment')+
scale_color_manual(values= temp1Palette)+
scale_shape_manual(values= shape_values)+
facet_wrap(~N, scales = 'free_x', labeller = labeller(N = labels_plot245))+
theme_bw()+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank()) +
theme(axis.title.x = element_text(size = 14,face = "plain", colour = "black", vjust = 0),
axis.text.x = element_text(size = 10,  colour = "black", angle = 0, vjust = 0.5)) +
theme(axis.title.y = element_text(size = 14, face = "plain", colour = "black", vjust = 1.8),
axis.text.y = element_text(size = 10,  colour = "black", angle = 0, hjust = 0.4)) +
theme(strip.background =element_rect(),
strip.text.x  = element_text(size = 12))+
theme(legend.position = 'right',
legend.key.size = unit(1, 'cm'),
legend.title = element_text(size=14),
legend.text = element_text(size=12))+
guides(color = guide_legend(override.aes = list(size = 3.5)))
plot245
legend_f<- get_legend(plot245)
nbef <- cowplot::plot_grid( NBE+theme(legend.position = 'none'),
plot245+theme(legend.position = 'none'),
legend_f,
hjust = -0.05,
ncol = 3,
labels = c('(c)', '(d)'),
rel_widths = c( 2/7,4/7,1/7))
(nbes/nbef)
ggsave(plot = last_plot(), file = here('output/Fig3_NBE_NBES.png'), width = 15, height = 9)
plot_grid(Quattroplot, mixplot, ncol = 1, rel_heights = c(6.5/10, 3/10),labels = c('(a)', '(b)'))
ggsave(plot = last_plot(), file = here('output/FigS4_QuattroMixBiomass.png'), width = 12, height = 12.5)
plot_grid(Quattroplot, mixplot, ncol = 1, rel_heights = c(7/10, 3/10),labels = c('(a)', '(b)'))
ggsave(plot = last_plot(), file = here('output/FigS4_QuattroMixBiomass.png'), width = 12, height = 12.5)
RR1 <- MonoData %>%
filter(label == 'Monoculture')%>%
ggplot(.)+
geom_hline(yintercept = 0, color = 'darkgrey')+
geom_errorbar(aes(x = combination, y = mean,ymin = mean - se, ymax = mean +se, color = temp), width = .3, alpha = .7)+
geom_point(aes(x = combination, y = mean, color = temp, shape = temp),size = 2.5, alpha = .6)+
labs(x = 'Combination', y = 'Observed OEV', color = 'Treatment', shape = 'Treatment')+
scale_colour_brewer(palette = "Set1")+
facet_wrap(~label,  ncol =2)+
scale_y_continuous(limits = c(-7,7))+
theme_bw()+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank()) +
theme(axis.title.x = element_text(size = 16,face = "plain", colour = "black", vjust = 0),
axis.text.x = element_text(size = 10,  colour = "black", angle = 0, vjust = 0.5)) +
theme(axis.title.y = element_text(size = 16, face = "plain", colour = "black", vjust = 1.8),
axis.text.y = element_text(size = 10,  colour = "black", angle = 0, hjust = 0.4)) +
theme(strip.background =element_rect(),
strip.text.x  = element_text(size = 12))+
guides(color = guide_legend(override.aes = list(size = 3.5)))+
theme(legend.position = 'right',
legend.key.size = unit(1, 'cm'),
legend.title = element_text(size=16),
legend.text = element_text(size=14))
RR1
RR2 <- MonoData %>%
filter(label == '2 species')%>%
ggplot(.)+
geom_hline(yintercept = 0, color = 'darkgrey')+
geom_errorbar(aes(x = combination, y = mean,ymin = mean - se, ymax = mean +se, color = temp), width = .3, alpha = .7)+
geom_point(aes(x = combination, y = mean, color = temp, shape = temp),size = 2.5, alpha = .6)+
labs(x = 'Combination', y = '', color = 'Treatment', shape = 'Treatment')+
scale_colour_brewer(palette = "Set1")+
facet_wrap(~label,  ncol =2)+
scale_y_continuous(limits = c(-7,7))+
theme_bw()+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank()) +
theme(axis.title.x = element_text(size = 16,face = "plain", colour = "black", vjust = 0),
axis.text.x = element_text(size = 10,  colour = "black", angle = 0, vjust = 0.5)) +
theme(axis.title.y = element_text(size = 16, face = "plain", colour = "black", vjust = 1.8),
axis.text.y = element_text(size = 10,  colour = "black", angle = 0, hjust = 0.4)) +
theme(strip.background =element_rect(),
strip.text.x  = element_text(size = 12))+
guides(color = guide_legend(override.aes = list(size = 3.5)))+
theme(legend.position = 'right',
legend.key.size = unit(1, 'cm'),
legend.title = element_text(size=16),
legend.text = element_text(size=14))
RR2
RR2 <- MonoData %>%
filter(label == '2 species')%>%
ggplot(.)+
geom_hline(yintercept = 0, color = 'darkgrey')+
geom_errorbar(aes(x = combination, y = mean,ymin = mean - se, ymax = mean +se, color = temp), width = .3, alpha = .7)+
geom_point(aes(x = combination, y = mean, color = temp, shape = temp),size = 2.5, alpha = .6)+
labs(x = 'Combination', y = '', color = 'Treatment', shape = 'Treatment')+
scale_colour_brewer(palette = "Set1")+
facet_wrap(~label,  ncol =2)+
scale_y_continuous(limits = c(-7,7))+
theme_bw()+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank()) +
theme(axis.title.x = element_text(size = 16,face = "plain", colour = "black", vjust = 0),
axis.text.x = element_text(size = 10,  colour = "black", angle = 0, vjust = 0.5)) +
theme(axis.title.y = element_text(size = 16, face = "plain", colour = "black", vjust = 1.8),
axis.text.y = element_text(size = 10,  colour = "black", angle = 0, hjust = 0.4)) +
theme(strip.background =element_rect(),
strip.text.x  = element_text(size = 12))+
guides(color = guide_legend(override.aes = list(size = 3.5)))+
theme(legend.position = 'right',
legend.key.size = unit(1, 'cm'),
legend.title = element_text(size=14),
legend.text = element_text(size=12))
RR2
RR1 <- MonoData %>%
filter(label == 'Monoculture')%>%
ggplot(.)+
geom_hline(yintercept = 0, color = 'darkgrey')+
geom_errorbar(aes(x = combination, y = mean,ymin = mean - se, ymax = mean +se, color = temp), width = .3, alpha = .7)+
geom_point(aes(x = combination, y = mean, color = temp, shape = temp),size = 2.5, alpha = .6)+
labs(x = 'Combination', y = 'Observed OEV', color = 'Treatment', shape = 'Treatment')+
scale_colour_brewer(palette = "Set1")+
facet_wrap(~label,  ncol =2)+
scale_y_continuous(limits = c(-7,7))+
theme_bw()+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank()) +
theme(axis.title.x = element_text(size = 16,face = "plain", colour = "black", vjust = 0),
axis.text.x = element_text(size = 10,  colour = "black", angle = 0, vjust = 0.5)) +
theme(axis.title.y = element_text(size = 16, face = "plain", colour = "black", vjust = 1.8),
axis.text.y = element_text(size = 10,  colour = "black", angle = 0, hjust = 0.4)) +
theme(strip.background =element_rect(),
strip.text.x  = element_text(size = 12))+
guides(color = guide_legend(override.aes = list(size = 3.5)))+
theme(legend.position = 'right',
legend.key.size = unit(1, 'cm'),
legend.title = element_text(size=14),
legend.text = element_text(size=12))
RR1
RR2 <- MonoData %>%
filter(label == '2 species')%>%
ggplot(.)+
geom_hline(yintercept = 0, color = 'darkgrey')+
geom_errorbar(aes(x = combination, y = mean,ymin = mean - se, ymax = mean +se, color = temp), width = .3, alpha = .7)+
geom_point(aes(x = combination, y = mean, color = temp, shape = temp),size = 2.5, alpha = .6)+
labs(x = 'Combination', y = '', color = 'Treatment', shape = 'Treatment')+
scale_colour_brewer(palette = "Set1")+
facet_wrap(~label,  ncol =2)+
scale_y_continuous(limits = c(-7,7))+
theme_bw()+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank()) +
theme(axis.title.x = element_text(size = 16,face = "plain", colour = "black", vjust = 0),
axis.text.x = element_text(size = 10,  colour = "black", angle = 0, vjust = 0.5)) +
theme(axis.title.y = element_text(size = 16, face = "plain", colour = "black", vjust = 1.8),
axis.text.y = element_text(size = 10,  colour = "black", angle = 0, hjust = 0.4)) +
theme(strip.background =element_rect(),
strip.text.x  = element_text(size = 12))+
guides(color = guide_legend(override.aes = list(size = 3.5)))+
theme(legend.position = 'right',
legend.key.size = unit(1, 'cm'),
legend.title = element_text(size=14),
legend.text = element_text(size=12))
RR2
RR4 <- MonoData %>%
filter(label == '4 species')%>%
ggplot(.)+
geom_hline(yintercept = 0, color = 'darkgrey')+
geom_errorbar(aes(x = combination, y = mean,ymin = mean - se, ymax = mean +se, color = temp), width = .3, alpha = .7)+
geom_point(aes(x = combination, y = mean, color = temp, shape = temp),size = 2.5, alpha = .6)+
labs(x = 'Combination', y = 'Observed OEV', color = 'Treatment', shape = 'Treatment')+
scale_colour_brewer(palette = "Set1")+
facet_wrap(~label,  ncol =2)+
scale_y_continuous(limits = c(-7,7))+
theme_bw()+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank()) +
theme(axis.title.x = element_text(size = 16,face = "plain", colour = "black", vjust = 0),
axis.text.x = element_text(size = 10,  colour = "black", angle = 0, vjust = 0.5)) +
theme(axis.title.y = element_text(size = 16, face = "plain", colour = "black", vjust = 1.8),
axis.text.y = element_text(size = 10,  colour = "black", angle = 0, hjust = 0.4)) +
theme(strip.background =element_rect(),
strip.text.x  = element_text(size = 12))+
guides(color = guide_legend(override.aes = list(size = 3.5)))+
theme(legend.position = 'right',
legend.key.size = unit(1, 'cm'),
legend.title = element_text(size=14),
legend.text = element_text(size=12))
RR4
RR5 <- MonoData %>%
filter(label == '5 species')%>%
ggplot(.)+
geom_hline(yintercept = 0, color = 'darkgrey')+
geom_errorbar(aes(x = combination, y = mean,ymin = mean - se, ymax = mean +se, color = temp), width = .3, alpha = .7)+
geom_point(aes(x = combination, y = mean, color = temp, shape = temp),size = 2.5, alpha = .6)+
labs(x = 'Combination', y = '', color = 'Treatment', shape = 'Treatment')+
scale_colour_brewer(palette = "Set1")+
facet_wrap(~label,  ncol =2)+
scale_y_continuous(limits = c(-7,7))+
theme_bw()+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank()) +
theme(axis.title.x = element_text(size = 16,face = "plain", colour = "black", vjust = 0),
axis.text.x = element_text(size = 10,  colour = "black", angle = 0, vjust = 0.5)) +
theme(axis.title.y = element_text(size = 16, face = "plain", colour = "black", vjust = 1.8),
axis.text.y = element_text(size = 10,  colour = "black", angle = 0, hjust = 0.4)) +
theme(strip.background =element_rect(),
strip.text.x  = element_text(size = 12))+
guides(color = guide_legend(override.aes = list(size = 3.5)))+
theme(legend.position = 'right',
legend.key.size = unit(2, 'cm'),
legend.title = element_text(size=14),
legend.text = element_text(size=12))
RR5
RR1+RR2+RR4+RR5+
plot_layout(widths = c( 3,3), nrow = 2)+ plot_layout(guides = 'collect')+
plot_annotation(tag_levels = "a", tag_prefix = '(',
tag_sep = '', tag_suffix = ')')
ggsave(plot = last_plot(), file = here('output/Fig2_ObservedStab_patchwork.png'),width = 11, height = 8)
RR5 <- MonoData %>%
filter(label == '5 species')%>%
ggplot(.)+
geom_hline(yintercept = 0, color = 'darkgrey')+
geom_errorbar(aes(x = combination, y = mean,ymin = mean - se, ymax = mean +se, color = temp), width = .3, alpha = .7)+
geom_point(aes(x = combination, y = mean, color = temp, shape = temp),size = 2.5, alpha = .6)+
labs(x = 'Combination', y = '', color = 'Treatment', shape = 'Treatment')+
scale_colour_brewer(palette = "Set1")+
facet_wrap(~label,  ncol =2)+
scale_y_continuous(limits = c(-7,7))+
theme_bw()+
theme(panel.grid.major=element_blank(),panel.grid.minor=element_blank()) +
theme(axis.title.x = element_text(size = 16,face = "plain", colour = "black", vjust = 0),
axis.text.x = element_text(size = 10,  colour = "black", angle = 0, vjust = 0.5)) +
theme(axis.title.y = element_text(size = 16, face = "plain", colour = "black", vjust = 1.8),
axis.text.y = element_text(size = 10,  colour = "black", angle = 0, hjust = 0.4)) +
theme(strip.background =element_rect(),
strip.text.x  = element_text(size = 12))+
guides(color = guide_legend(override.aes = list(size = 3.5)))+
theme(legend.position = 'right',
legend.key.size = unit(1, 'cm'),
legend.title = element_text(size=14),
legend.text = element_text(size=12))
RR5
RR1+RR2+RR4+RR5+
plot_layout(widths = c( 3,3), nrow = 2)+ plot_layout(guides = 'collect')+
plot_annotation(tag_levels = "a", tag_prefix = '(',
tag_sep = '', tag_suffix = ')')
ggsave(plot = last_plot(), file = here('output/Fig2_ObservedStab_patchwork.png'),width = 11, height = 8)
